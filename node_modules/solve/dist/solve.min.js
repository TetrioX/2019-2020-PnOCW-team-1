var solve=function(n){"use strict";function r(n){return!n||!t(n)&&!o(n)}function t(n){return"function"==typeof n}function e(n){return n.constructor===Array}function o(n){return"object"==typeof n}function f(){throw new ReferenceError("Unable to add listener after calling destroy")}function i(n){return n}function u(o){var l,s,h,v,y,g=a.call(arguments,1),d=function(n){var t=o[n];r(t)||u(t,function(r){o[n]=r,y&&b(o)})},p=function(n){n&&t(n.then)?n.then(p):t(n)?(h=n(p),y||p(h)):b(n)},b=function(n){y=1;var r;for(r=0;r<g.length;r++)n=g[r](n);if(l)for(r=0;r<l.length;r++)l[r](n);s=n},w=function(n){function r(r){for(var e=0;e<n.length;e++)r=n[e](r);t(r)}var t;A&&A();var e=u(function(n){t=n},i),o=e.destroy;return r.destroy=e.destroy=function(){if(l)for(var n=0;n<l.length;n++)if(r===l[n]){l.splice(n,1);break}o()},l||(l=[]),l.push(r),r(s),e},m=function(){var n=a.call(arguments,0);return w(n)},A=function(){if(r(o))b(o);else if(t(o))h=o(p),y||p(h);else if(t(o.then))o.then(p),y||b();else{if(e(o))for(v=0;v<o.length;v++)d(v);else for(v in o)c.call(o,v)&&d(v);y=1,b(o)}A=n};return g.length>0&&A(),m.destroy=function(){if(l)for(var r=0;r<l.length;r++)l[r].destroy();l=o=n,w=f},m}var c={}.hasOwnProperty,a=Array.prototype.slice;return u}();